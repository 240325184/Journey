mysqlx_port=30010
1. 下载软件
2. 创建目录及用户
3. 添加配置文件
4. 初始化
/xs/mgrtest/app/mysql8018/bin/mysqld --defaults-file=./my3001.cnf --initialize --user=mysql
5. 准备启动脚本
启动实例


在主节点上操作
#安装插件
INSTALL PLUGIN group_replication SONAME 'group_replication.so'; 
#创建复制账号及授权
SET SQL_LOG_BIN=0; #关闭binlog
CREATE USER repl@'%' IDENTIFIED BY 'repl'; 
grant replication slave,replication client on *.* to repl@'%';
FLUSH PRIVILEGES;
SET SQL_LOG_BIN=1;
#创建复制
CHANGE MASTER TO MASTER_USER='repl', MASTER_PASSWORD='repl' FOR CHANNEL 'group_replication_recovery'; 


建个群(官方点的说法就是初始化一个复制组
set global group_replication_bootstrap_group=on;
start group_replication;
set global group_replication_bootstrap_group=off;
select * from performance_schema.replication_group_members;


在从节点上操作
#安装插件
INSTALL PLUGIN group_replication SONAME 'group_replication.so'; 
#创建复制账号及授权
SET SQL_LOG_BIN=0; #关闭binlog
CREATE USER repl@'%' IDENTIFIED BY 'repl'; 
grant replication slave,replication client on *.* to repl@'%';
FLUSH PRIVILEGES;
SET SQL_LOG_BIN=1;
#创建复制
CHANGE MASTER TO MASTER_USER='repl', MASTER_PASSWORD='repl' FOR CHANNEL 'group_replication_recovery'; 
start group_replication;





切换为MGR多主模式
#以下步骤所有节点均执行
stop group_replication;
#是否启动单主模式，如果启动，则本实例是主库，提供读写，其他实例仅提供读,如果为off就是多主模式了
mysql> set global group_replication_single_primary_mode=OFF;
#多主模式下,强制检查每一个实例是否允许该操作,如果不是多主,可以关闭
mysql> set global group_replication_enforce_update_everywhere_checks=ON;
#只在一个节点上执行，任意节点都可以
mysql> SET GLOBAL group_replication_bootstrap_group=ON; 
mysql> START GROUP_REPLICATION; 
mysql> SET GLOBAL group_replication_bootstrap_group=OFF;
#在其余节点执行
mysql> START GROUP_REPLICATION; 
mysql> SELECT * FROM performance_schema.replication_group_members;


#以下步骤所有节点均执行
mysql> stop group_replication;
mysql> set global group_replication_enforce_update_everywhere_checks=OFF;
mysql> set global group_replication_single_primary_mode=ON;
#主节点执行，在192.168.0.118上执行
SET GLOBAL group_replication_bootstrap_group=ON; 
START GROUP_REPLICATION; 
SET GLOBAL group_replication_bootstrap_group=OFF;
#在其余节点执行
START GROUP_REPLICATION; 
# 查看MGR组信息
mysql> SELECT * FROM performance_schema.replication_group_members;